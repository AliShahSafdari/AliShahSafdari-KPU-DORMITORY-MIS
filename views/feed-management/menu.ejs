<div class="content-area py-1">
	<div class="container-fluid">
		<h4>تابلوی حواله ی اعاشه</h4>
		<ol class="breadcrumb no-bg mb-1">
			<li class="breadcrumb-item"><a href="/feed-management/show-daily-menus">مدیریت ارتزاقی</a></li>
			<li class="breadcrumb-item active">تابلوی حواله ی اعاشه</li>
		</ol>
		<% if (user.position === "مدیر ارتزاقی") { %>
		<% if(errors.length > 0 || typeof message.erorr_msg !== 'undefined'){ %>
		<% if(path == "/feed-management/show-stock"){ %>
		<script>
			$(window).on('load', () => $('.large-modal').modal('show'));
		</script>
		<% } %>
		<% if(path == "/feed-management/show-stock/add-new"){ %>
		<script>
			$(window).on('load', () => $('.large-modal2').modal('show'));
		</script>
		<% } %>
		<% } %>
		<div class="row">
			<div class="bg-white">
				<div class="modal fade large-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
								<h4 class="modal-title" id="mySmallModalLabel">اضافه کردن ماده غذایی جدید به منوی
									(<%= thisMenu %>) </h4>
							</div>
							<div class="modal-body">
								<form action="/feed-management/add-to-menu" method="POST">
									<input type="hidden" name="menuType" value="<%= thisMenu %>">
									<div class="row">
										<div class="col-xs-12">
											<h5>دیپو</h5>
											<div class="form-group row">
												<label class="col-xs-3 col-form-label">نام جنس</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر صبح</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر
													چاشت</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر شب</label>
												<label class="col-xs-3 col-form-label">کالوری</label>
											</div>
											<div class="form-group row">
												<div class="col-xs-3">
													<select name="ingradient_stock" class="form-control">
														<option value="" class="active">انتخاب ماده غذایی</option>
														<% ingradients_stk.forEach(element => { %>
														<option value="<%= element._id %>">
															<%= element.ingradient %>
														</option>
														<% }); %>
													</select>
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="morningIngradientAmount_stock" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="noonIngradientAmount_stock" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="nightIngradientAmount_stock" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="calory_stock" min="0" max="10000" placeholder="0 calory">
												</div>
											</div>
										</div>
									</div>
									<br>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<button type="submit" class="btn btn-primary">
													اضافه کردن
												</button>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>


				<div class="modal fade large-modal2" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
								<h4 class="modal-title" id="mySmallModalLabel">اضافه کردن ماده غذایی جدید به منوی
									(<%= thisMenu %>) </h4>
							</div>
							<div class="modal-body">
								<form action="/feed-management/add-to-menu" method="POST">
									<input type="hidden" name="menuType" value="<%= thisMenu %>">

									<div class="row">
										<div class="col-md-12">
											<h5>تازه</h5>
											<div class="form-group row">
												<label class="col-xs-3 col-form-label">نام جنس</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر
													صبح</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر
													چاشت</label>
												<label class="col-xs-2 col-form-label">(گرام) استحقاق یک نفر
													شب</label>
												<label class="col-xs-3 col-form-label">کالوری</label>
											</div>
											<div class="form-group row">
												<div class="col-xs-3">
													<input class="form-control" type="text" name="ingradient_m7" min="0"
														placeholder="ماده غذایی">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="morningIngradientAmount_m7" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="noonIngradientAmount_m7" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="nightIngradientAmount_m7" min="0" max="1000"
														placeholder="0.00 gr">
												</div>
												<div class="col-xs-2">
													<input class="form-control" type="number" step="any"
														name="calory_m7" min="0" max="10000" placeholder="0 calory">
												</div>
											</div>
										</div>
									</div>

									<br>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<button type="submit" class="btn btn-primary">
													اضافه کردن
												</button>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<% } %>

		<div class="box box-block bg-white">
			<input type="hidden" id="menuType" value="<%= thisMenu %>">
			<div class="row">
				<div class="col-xs-5">
					<% if (user.position === "مدیر ارتزاقی") { %>
					<button class="btn btn-primary inline" data-toggle="modal" data-target=".large-modal">
						<li class="fa fa-plus"></li>&nbsp; دیپو
					</button>
					<button class="btn btn-primary inline" data-toggle="modal" data-target=".large-modal2">
						<li class="fa fa-plus"></li>&nbsp; تازه
					</button>
					<% } %>
				</div>
				<div class="col-xs-5">
					<h3 class="mb-1" style="float: right;">تابلوی اعاشه (<%= thisMenu %>)</h3>
				</div>
				<div class="col-xs-2">
					<% if (user.position === "مدیر ارتزاقی") { %>
					<a data-toggle="modal" data-target="#choose2" onclick="sendId2(event)" href="<%= thisMenu %>">
						<button class="btn btn-danger" style="float: left;">
							<li class="fa fa-trash"></li>&nbsp; حذف تابلو
						</button>
					</a>
					<% } %>
				</div>
			</div>
			<br>
			<table class="table table-striped table-bordered dataTable">
				<thead>
					<tr>
						<th>شماره</th>
						<th>نام جنس</th>
						<th>استحقاق یک نفر در صبح (گرام)</th>
						<th>استحقاق یک نفر در چاشت (گرام)</th>
						<th>استحقاق یک نفر در شب (گرام)</th>
						<th>کالوری</th>
						<% if (user.position === "مدیر ارتزاقی") { %>
						<th>ویرایش</th>
						<th>حذف</th>
						<% } %>
					</tr>
				</thead>
				<tbody>
					<% let i = 1; %>
					<% ingradients.forEach((element) => { %>
					<tr>
						<td><%= i++ %> </td>
						<td><%= element.ingradient %></td>
						<td><%= element.morningIngradientAmount %></td>
						<td><%= element.noonIngradientAmount %></td>
						<td><%= element.nightIngradientAmount %></td>
						<td><%= element.calory %></td>
						<% if (user.position === "مدیر ارتزاقی") { %>
						<td style="text-align: center;">
							<a href="/feed-management/menu/edit-menu/<%= element.menuType %>/<%= element.id %>">
								<span class="fa fa-edit" style="color: rgb(31, 219, 31);"></span>
							</a>
						</td>
						<td style="text-align: center;">
							<a data-toggle="modal" data-target="#confirm" onclick="sendId(event)"
								href="<%= element.id %>">
								<span class="fa fa-trash-o" style="color: red"></span>
							</a>
						</td>
						<% } %>
					</tr>
					<% }) %>
				</tbody>
			</table>


			<!-- edit and delete chooseing modal -->
			<div class="modal animated bounceInUp small-modal" id="choose" tabindex="-1" role="dialog"
				aria-labelledby="mySmallModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">×</span>
							</button>
						</div>
						<div class="modal-body">
							لطفا یکی از گزینه های زیر را انتخاب نمایید.
						</div>
						<div class="modal-footer">
							<a href="" data-toggle="modal" data-target="#confirm"
								class="btn btn-danger col-md-5">حذف</a>
							<span class="col-md-2"></span>
							<a href="" id="edit" class="btn btn-primary col-md-5" style="margin-left: 0px;">ویرایش</a>
						</div>
					</div>
				</div>
			</div>

			<!-- deleting confirmation modal -->
			<div class="modal animated bounceInUp small-modal" id="confirm" tabindex="-1" role="dialog"
				aria-labelledby="mySmallModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">×</span>
							</button>
							<h4 class="modal-title" id="mySmallModalLabel">هشدار!</h4>
						</div>
						<div class="modal-body">
							آیا از حذف این جنس مطمئن هستید؟
						</div>
						<div class="modal-footer">
							<a href="" id="delete" class="btn btn-danger col-md-5" style="margin-right: 0px;">بله</a>
							<span class="col-md-2"></span>
							<a href="" class="btn btn-primary col-md-5" style="margin-left: 0px;">خیر</a>
						</div>
					</div>
				</div>
			</div>
		</div>


		<!-- deleting confirmation modal -->
		<div class="modal animated bounceInUp small-modal" id="choose2" tabindex="-1" role="dialog"
			aria-labelledby="mySmallModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-sm">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">×</span>
						</button>
						<h4 class="modal-title" id="mySmallModalLabel">هشدار!</h4>
					</div>
					<div class="modal-body">
						آیا از حذف این تابلو مطمئن هستید؟
					</div>
					<div class="modal-footer">
						<a href="" id="delete2" class="btn btn-danger col-md-5" style="margin-right: 0px;">بله</a>
						<span class="col-md-2"></span>
						<a href="" class="btn btn-primary col-md-5" style="margin-left: 0px;">خیر</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
	function sendId(ev) {
		// let editRout = "/feed-management/menu/edit-menu/" + document.getElementById('menuType').getAttribute("value") + "/" + ev.currentTarget.getAttribute("href");
		let deleteRout = "/feed-management/menu/delete-ingradient/" + document.getElementById('menuType').getAttribute("value") + "/" + ev.currentTarget.getAttribute("href");

		// console.log(editRout);
		// document.getElementById("edit").setAttribute("href", editRout);

		console.log(deleteRout);
		document.getElementById("delete").setAttribute("href", deleteRout);

	}

	function sendId2(ev) {
		let deleteRout = "/feed-management/menu/delete-menu/" + document.getElementById('menuType').getAttribute("value");

		console.log(deleteRout);
		document.getElementById("delete2").setAttribute("href", deleteRout);

	}
</script>