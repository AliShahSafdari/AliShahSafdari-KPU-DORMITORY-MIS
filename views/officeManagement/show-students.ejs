<!-- table -->
<!-- Content -->
<div class="content-area py-1">
	<!-- add student modal -->
	<div class="container-fluid">
		<% if (user.position === "مدیر اداری"){
			if(errors.length>0 || typeof message.error_msg !== 'undefined'){ %>
				<script>
					$(window).on('load',()=>$('.large-modal').modal('show'));
				</script>
		<%	}} %>
		<div class="row">
			<div class="bg-white">
				<div class="modal fade large-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close">
									<span aria-hidden="true">×</span>
								</button>
								<h4 class="modal-title" id="mySmallModalLabel">اضافه کردن محصل جدید</h4>
							</div>
							<div class="modal-body">

								<form action="/office-management/add-new-student1" method="POST" enctype="multipart/form-data">
									<br>
									<div class="form-group row">
										<label for="example-text-input1" class="col-xs-1 col-form-label">آیدی</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
											errors.forEach(error=>{
												if(error.name==='studentId'){%>
													has-danger
											<%} }) } %>">
											<input class="form-control" type="text" name="studentId" placeholder="آیدی محصل"
												id="example-text-input1" required autofocus>
											<% if(typeof errors!== 'undefined'){ errors.forEach(error=>{
												if(error.name==='studentId'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input1" class="col-xs-1 col-form-label">نام</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
											errors.forEach(error=>{
												if(error.name==='name'){%>
													has-danger
											<%} }) } %>">
											<input class="form-control" type="text" name="name" placeholder="نام و نام خانوادگی"
												id="example-text-input1" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='name'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row">
										<label for="example-text-input12" class="col-xs-1 col-form-label">نام
											پدر</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='fName'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="fName" placeholder="نام پدر"
												id="example-text-input2" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='fName'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input3" class="col-xs-1 col-form-label">نام پدر
											کلان</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='gFName'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="gFName" placeholder="نام پدر کلان"
												id="example-text-input3" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='gFName'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row">
										<label for="example-text-input4" class="col-xs-1 col-form-label">صنف</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='classroom'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="classroom" placeholder="صنف"
												id="example-text-input4" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='classroom'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input5" class="col-xs-1 col-form-label">پوهنحی</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='faculty'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="faculty" placeholder="پوهنحی"
												id="example-text-input5" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='faculty'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row">
										<label for="example-text-input6" class="col-xs-1 col-form-label">دیپارتمنت</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='department'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="department" placeholder="دیپارتمنت"
												id="example-text-input6" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='department'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input7" class="col-xs-1 col-form-label">ولایت</label>
										<div class="col-xs-5 <% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='province'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="province" placeholder="ولایت"
												id="example-text-input7" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='province'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row">
										<label for="example-text-input8" class="col-xs-1 col-form-label">ولسوالی</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='destrict'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="destrict" placeholder="ولسوالی"
												id="example-text-input8" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='destrict'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input9" class="col-xs-1 col-form-label">نمبر
											تذکره</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='tazkiraNum'){%>
												has-danger
										<%} }) } %>">
											<input class="form-control" type="text" name="tazkiraNum" placeholder="نمبر تذکره"
												id="example-text-input9" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='tazkiraNum'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row ">
										<label for="example-text-input10" class="col-xs-1 col-form-label ">نمبر
											تلفون</label>
										<div class="col-xs-5 <% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='phonNum'){%>
												has-danger
										<% } }) } %>">
											<input class="form-control" type="text" name="phonNum" placeholder="شماره تماس"
												id="example-text-input10" required>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='phonNum'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
										<label for="example-text-input12" class="col-xs-1 col-form-label"> کوایف</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='kawayef'){%>
												has-danger
										<%} }) } %>">
											<select class="form-control mb-1" name="kawayef" required>
												<option value="exist">برحال</option>
												<option value="hanging">تعجیل</option>
												<option value="graduated">فارغ</option>
												<option value="suspension">ناکام</option>
												<option value="uderPercent">زیر فیصدی</option>
												<option value="repeatSemester">تکرار سمستر</option>
											</select>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='status'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
					
									</div>
					
									<div class="form-group row ">
										<label for="example-text-input12" class="col-xs-1 col-form-label ">اپلود
											تصویر</label>
										<div class="col-xs-5 <% if(typeof errors!==undefined){ 
											errors.forEach(error=>{
												if(error.name=== 'photo.name' || 'photo.size' || 'photo.mimetype'){%>
													has-danger
												<%} }) } %>">
											<label class="custom-file">
												<input type="file" id="file" name="photo" class="custom-file-input form-control" required>
												<span class="custom-file-control "></span>
												<% if(typeof errors!==undefined){ errors.forEach(error=>{
													if(error.name=== 'photo.name' || 'photo.size' || 'photo.mimetype'){%>
													<div class="form-control-feedback">
														<%= error.message %>
													</div>
													<%} }) } %>
											</label>
										</div>
					
										<label for="example-text-input12" class="col-xs-1 col-form-label"> نام کتاب</label>
										<div class="col-xs-5<% if(typeof errors!== undefined){
										errors.forEach(error=>{
											if(error.name==='bookName'){%>
												has-danger
										<%} }) } %>">
										<select class="form-control mb-1" name="bookName" required>
											<% books.forEach(book=> { %>
												<option value="<%= book._id %>">
													کتاب <%= book.bookName %> بلاک <%= book.blockNum %> منزل <%= book.floorNum %> جلد <%= book.year %>
												</option>
											<%});%>
										</select>
											<% if(typeof errors!==undefined){ errors.forEach(error=>{
												if(error.name==='bookName'){%>
												<div class="form-control-feedback">
													<%= error.message %>
												</div>
												<%} }) } %>
										</div>
									</div>
					
									<div class="form-group row">
										<label for="example-text-input12" class="col-xs-1 col-form-label">تاریخ</label>
										<div class="col-xs-5">
											<input type="date" name="date" class="form-control" required>
										</div>
									</div>
					
									<div class="form-group row">
										<label for="example-number-input" class="col-xs-1 col-form-label">ذخیره
											کردن</label>
										<div class="col-xs-11">
											<button type="submit" class="btn btn-primary">ذخیره</button>
										</div>
									</div>
								</form>

							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<h4>
			<%= pageTittle %>
		</h4>
		<ol class="breadcrumb no-bg mb-1">
			<li class="breadcrumb-item"><a href="/">خانه</a></li>
			<li class="breadcrumb-item"><a href="/office-management">مدیریت اداری</a></li>
			<li class="breadcrumb-item active">
				<%= pageTittle %>
			</li>
		</ol>
		<!-- Content -->
		<% if(records.length>0){ %>
		<div class="box box-block bg-white">
			<div class="overflow-x-auto">
				<div class="col-xs-5">
					<button class="btn btn-primary inline" style="float: right;" data-toggle="modal"
						data-target=".large-modal">اضافه کردن شاگرد</button>
				</div>
				<table class="table table-striped table-bordered dataTable" id="table-3">
					<thead>
						<tr>
							<th>تصویر محصل</th>
							<th>آی دی</th>
							<th>نام</th>
							<th>نام پدر</th>
							<th>نام پدر کلان</th>
							<th>صنف</th>
							<th>پوهنحی</th>
							<th>دیپارتمنت</th>
							<th>شماره تماس</th>
							<th>نمبر تذکره</th>
							<th>ولایت</th>
							<th>ولسوالی</th>
							<% if (user.position!=="آمر لیلیه" ) { %>
								<th>ویرایش</th>
							<% } %>
							<% if (user.position!=="آمر لیلیه" ) { %>
								<th>حذف</th>
							<% } %>
						</tr>
					</thead>
					<tbody>

						<% for(let record of records){ %>
						<tr>
							<td style="padding: 0px;margin:0px;">
								<img src="/img/student_imgs/<%= record.photo %>" alt="تصویر محصل" width="70px">
							</td>
							<td>
								<%= record.studentId %>
							</td>
							<td>
								<%= record.name %>
							</td>
							<td>
								<%= record.fName %>
							</td>
							<td>
								<%= record.gFName %>
							</td>
							<td>
								<%= record.classroom %>
							</td>
							<td>
								<%= record.faculty %>
							</td>
							<td>
								<%= record.department %>
							</td>
							<td>
								<%= record.phonNum %>
							</td>
							<td>
								<%= record.tazkiraNum %>
							</td>
							<td>
								<%= record.province %>
							</td>
							<td>
								<%= record.destrict %>
							</td>
							<% if (user.position!=="آمر لیلیه" ) { %>
								<td style="text-align:center;">
									
									<a href="/office-management/edit-student/<%= record._id %>">
	
										<span class="fa fa-edit" style="color:rgb(31,219,31) ;"></span>
									</a>
								</td>
								<td style="text-align: center;">
									<a href="<%= record._id %>" data-toggle="modal" data-target="#confirm"
										onclick="sendId(event)">
										<span class="fa fa-trash-o" style="color:red"></span>
									</a>
								</td>
							<% } %>
						</tr>
						<% } %>
					</tbody>
					<tfoot>
						<tr>
							<th>تصویر محصل</th>
							<th>آی دی</th>
							<th>نام</th>
							<th>نام پدر</th>
							<th>نام پدر کلان</th>
							<th>صنف</th>
							<th>پوهنحی</th>
							<th>دیپارتمنت</th>
							<th>شماره تماس</th>
							<th>نمبر تذکره</th>
							<th>ولایت</th>
							<th>ولسوالی</th>
							<% if (user.position!=="آمر لیلیه" ) { %>
								<th>ویرایش</th>
							<% } %>
							<% if (user.position!=="آمر لیلیه" ) { %>
								<th>حذف</th>
							<% } %>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>
	</div>
				<!-- deleting confirmation modal -->
				<div class="modal animated bounceInUp small-modal" id="confirm" tabindex="-1" role="dialog"
				aria-labelledby="mySmallModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-sm">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">×</span>
							</button>
							<h4 class="modal-title" id="mySmallModalLabel">هشدار!</h4>
						</div>
						<div class="modal-body">
							<h5>
								آیا از حذف این محصل مطمئن هستید؟
							</h5>
						</div>
						<div class="modal-footer">
							<a href="" id="delete" class="btn btn-danger col-md-5" style="margin-right: 0px;">بله</a>
							<span class="col-md-2"></span>
							<a href="" class="btn btn-primary col-md-5" style="margin-left: 0px;">خیر</a>
						</div>
					</div>
				</div>
			</div>

	<% }else{ %>
	<div class="m-2">
		<h2 class="center">در حال حاظر هیچ محصل توسط شما در دیتابس ثبت نشده است</h2>
	</div>
	<% } %>
</div>


<script>
	function sendId(ev) {
		let deleteRout = "/office-management/delete-student/" + ev.currentTarget.getAttribute("href");

		console.log(deleteRout);
		document.getElementById("delete").setAttribute("href", deleteRout);

	}
</script>